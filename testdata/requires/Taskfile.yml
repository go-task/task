version: '3'

tasks:
  default:
    - task: missing-var

  missing-var:
    requires:
      vars:
        - FOO
    cmd: echo "{{.FOO}}"

  var-defined-in-task:
    vars:
      FOO: bar
    requires:
      vars:
        - FOO
    cmd: echo "{{.FOO}}"

  validation-var-dynamic:
    vars:
      FOO:
        sh: echo "one"
    requires:
      vars:
        - name: FOO
          enum: ['one', 'two']

  validation-var:
    requires:
      vars:
        - ENV
        - name: FOO
          enum: ['one', 'two']

  require-before-compile:
    requires:
      vars: [ MY_VAR ]
    cmd: |
      {{range .MY_VAR | splitList " " }}
        echo {{.}}
      {{end}}

  require-null:
    vars:
      FOO: null
    cmds:
      - echo "{{.FOO}}"
    requires:
      vars: [FOO]

  require-empty-string:
    vars:
      FOO: ''
    cmds:
      - echo "{{.FOO}}"
    requires:
      vars: [FOO]

  require-empty-template:
    vars:
      FOO: '{{.C}}'
    cmds:
      - echo "{{.FOO}}"
    requires:
      vars: [FOO]

  require-empty-dynamic-var:
    vars:
      FOO:
        sh: echo ""
    cmds:
      - echo "{{.FOO}}"
    requires:
      vars: [FOO]
